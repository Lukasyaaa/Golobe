import React, { type FC } from "react";
import { FILL_RULE, SITE_PARTS, STROKE_LINECAP, STROKE_LINEJOIN, transformIconViewbox, type IconParams, type Image, type objType } from "../../../../types";
import { TicketFeature } from "./Feature";
import type { Feature } from "../../../../pages/Details";

export const FEATURES_DESCRIPTION = {
    date: "Date",
    flightTime: "Flight time",
    gate: "Gate",
    seat: "Seat",
    checkIn: "Check In",
    checkOut: "Check Out",
    room: "Room no."
} as const;

interface TicketProps{
    startString: string, startDescription: string, startDate: string
    endString: string, endDescription: string, endDate: string
    serviceDescription: string,
    features: Feature[],
    images: Image[], contentType: objType<typeof SITE_PARTS>
}

export const Ticket: FC<TicketProps> = ({
    startString, endString, startDate, endDate, startDescription, endDescription, 
    serviceDescription, features, images, contentType
}) => {
    const iconValue: IconParams = (contentType === SITE_PARTS.flights) 
        ? {
            viewbox: {minX: 0, minY: 0, width: 22.5, height: 19.5}, width: 22.5, height: 19.5, pathes: [
                {fillRule: FILL_RULE.nonzero, fill: "rgba(17, 34, 17, 0.2)", stroke: "unset", strokeLinecap: STROKE_LINECAP.butt, strokeWidth: "unset", strokeLinejoin: STROKE_LINEJOIN.miter, d: "M7.99733 19.5L6.74952 19.5C6.62414 19.5 6.50077 19.4685 6.39069 19.4085C6.28062 19.3484 6.18735 19.2618 6.11941 19.1564C6.05147 19.051 6.01104 18.9303 6.0018 18.8052C5.99257 18.6802 6.01483 18.5548 6.06655 18.4406L9.08811 11.7727L4.55108 11.6719L2.89639 13.6767C2.58092 14.0733 2.32921 14.25 1.68702 14.25L0.847018 14.25C0.714021 14.2543 0.581951 14.2264 0.462001 14.1688C0.342051 14.1112 0.237757 14.0255 0.157956 13.9191C0.0463932 13.7686 -0.0632942 13.5136 0.0435808 13.1498L0.972643 9.82172C0.979674 9.79688 0.988112 9.77203 0.997487 9.74766C0.997954 9.74534 0.997954 9.74295 0.997487 9.74063C0.987806 9.71627 0.979512 9.69139 0.972643 9.66609L0.0426433 6.31687C-0.058138 5.96016 0.0520182 5.71078 0.162643 5.56406C0.236929 5.46549 0.333306 5.38573 0.444026 5.33118C0.554747 5.27664 0.676722 5.24883 0.800143 5.25L1.68702 5.25C2.16655 5.25 2.63202 5.46516 2.90577 5.8125L4.52624 7.78359L9.08811 7.71609L6.06749 1.05984C6.0157 0.94568 5.99335 0.820355 6.00249 0.695327C6.01163 0.570298 6.05196 0.449555 6.1198 0.344135C6.18764 0.238715 6.28082 0.151982 6.39083 0.0918644C6.50083 0.0317468 6.62416 0.000162838 6.74952 0L8.01092 0C8.1869 0.00353644 8.35983 0.0466697 8.51685 0.126197C8.67388 0.205724 8.81097 0.319602 8.91796 0.459375L14.7797 7.58437L17.4876 7.51312C17.6859 7.50234 18.2353 7.49859 18.3623 7.49859C20.9526 7.5 22.4995 8.34094 22.4995 9.75C22.4995 10.1934 22.3223 11.0156 21.1369 11.5387C20.437 11.8481 19.5033 12.0047 18.3614 12.0047C18.2358 12.0047 17.6878 12.0009 17.4867 11.9902L14.7792 11.918L8.90296 19.043C8.79588 19.1821 8.65891 19.2954 8.50216 19.3746C8.3454 19.4537 8.17288 19.4965 7.99733 19.5Z"}
            ]
        } 
        : {
            viewbox: {minX: 0, minY: 0, width: 14, height: 15}, width: 21, height: 22.5, pathes: [
                {fillRule: FILL_RULE.nonzero, fill: "rgba(17, 34, 17, 0.2)", stroke: "unset", strokeLinecap: STROKE_LINECAP.butt, strokeWidth: "unset", strokeLinejoin: STROKE_LINEJOIN.miter, d: "M 12.5,5 H 9 V 1.5 C 9,1.10218 8.84196,0.72064 8.56066,0.43934 8.27936,0.158035 7.89783,0 7.5,0 h -6 C 1.10218,0 0.72064,0.158035 0.43934,0.43934 0.15804,0.72064 0,1.10218 0,1.5 v 13 c 0,0.1326 0.05268,0.2598 0.14645,0.3536 C 0.24021,14.9473 0.36739,15 0.5,15 H 3.75 C 3.8163,15 3.87989,14.9737 3.92678,14.9268 3.97366,14.8799 4,14.8163 4,14.75 v -2.2359 c 0,-0.2691 0.20687,-0.5 0.47594,-0.5135 0.0676,-0.0032 0.13516,0.0073 0.19859,0.0309 0.06343,0.0236 0.1214,0.0599 0.17039,0.1066 0.049,0.0467 0.08801,0.1028 0.11467,0.165 C 4.98625,12.3653 4.99999,12.4323 5,12.5 v 2.25 c 0,0.0663 0.02634,0.1299 0.07322,0.1768 C 5.12011,14.9737 5.1837,15 5.25,15 h 8.25 c 0.1326,0 0.2598,-0.0527 0.3536,-0.1464 C 13.9473,14.7598 14,14.6326 14,14.5 v -8 C 14,6.10218 13.842,5.72064 13.5607,5.43934 13.2794,5.15804 12.8978,5 12.5,5 Z M 2.065,12.9959 C 1.96145,13.0095 1.85625,12.9903 1.76418,12.941 1.67211,12.8917 1.59778,12.8148 1.55163,12.7211 1.50548,12.6274 1.48982,12.5216 1.50686,12.4186 c 0.01703,-0.103 0.0659,-0.1981 0.13975,-0.272 0.07384,-0.0738 0.16896,-0.1227 0.272,-0.1397 0.10303,-0.0171 0.20882,-0.0014 0.3025,0.0447 0.09369,0.0462 0.17057,0.1205 0.21986,0.2126 0.04929,0.0921 0.06851,0.1972 0.05497,0.3008 -0.01429,0.1093 -0.06429,0.2108 -0.14223,0.2887 -0.07793,0.0779 -0.17943,0.1279 -0.28871,0.1422 z m 0,-2.5 C 1.96145,10.5095 1.85625,10.4903 1.76418,10.441 1.67211,10.3917 1.59778,10.3148 1.55163,10.2211 1.50548,10.1274 1.48982,10.0216 1.50686,9.9186 1.52389,9.8156 1.57276,9.7205 1.64661,9.6466 1.72045,9.5728 1.81557,9.5239 1.91861,9.5069 2.02164,9.48982 2.12743,9.5055 2.22111,9.5516 2.3148,9.5978 2.39168,9.6721 2.44097,9.7642 2.49026,9.8563 2.50948,9.9614 2.49594,10.065 2.48165,10.1743 2.43165,10.2758 2.35371,10.3537 2.27578,10.4316 2.17428,10.4816 2.065,10.4959 Z m 0,-2.49996 C 1.96145,8.00948 1.85625,7.99026 1.76418,7.94097 1.67211,7.89168 1.59778,7.8148 1.55163,7.72111 1.50548,7.62743 1.48982,7.52164 1.50686,7.41861 1.52389,7.31557 1.57276,7.22045 1.64661,7.14661 1.72045,7.07276 1.81557,7.02389 1.91861,7.00686 2.02164,6.98982 2.12743,7.00548 2.22111,7.05163 2.3148,7.09778 2.39168,7.17211 2.44097,7.26418 2.49026,7.35625 2.50948,7.46145 2.49594,7.565 2.48165,7.67428 2.43165,7.77578 2.35371,7.85371 2.27578,7.93165 2.17428,7.98164 2.065,7.99594 Z m 0,-2.5 C 1.96145,5.50948 1.85625,5.49026 1.76418,5.44097 1.67211,5.39168 1.59778,5.3148 1.55163,5.22111 1.50548,5.12743 1.48982,5.02164 1.50686,4.91861 1.52389,4.81557 1.57276,4.72045 1.64661,4.64661 1.72045,4.57276 1.81557,4.52389 1.91861,4.50686 2.02164,4.48982 2.12743,4.50548 2.22111,4.55163 2.3148,4.59778 2.39168,4.67211 2.44097,4.76418 2.49026,4.85625 2.50948,4.96145 2.49594,5.065 2.48165,5.17428 2.43165,5.27578 2.35371,5.35371 2.27578,5.43164 2.17428,5.48164 2.065,5.49594 Z m 0,-2.5 C 1.96145,3.00948 1.85625,2.99026 1.76418,2.94097 1.67211,2.89168 1.59778,2.8148 1.55163,2.72111 1.50548,2.62743 1.48982,2.52164 1.50686,2.41861 1.52389,2.31557 1.57276,2.22045 1.64661,2.14661 1.72045,2.07276 1.81557,2.02389 1.91861,2.00686 2.02164,1.98982 2.12743,2.00548 2.22111,2.05163 2.3148,2.09778 2.39168,2.17211 2.44097,2.26418 2.49026,2.35625 2.50948,2.46145 2.49594,2.565 2.48165,2.67428 2.43165,2.77578 2.35371,2.85371 2.27578,2.93165 2.17428,2.98165 2.065,2.99594 Z m 2.5,7.49996 C 4.46145,10.5095 4.35625,10.4903 4.26418,10.441 4.17211,10.3917 4.09778,10.3148 4.05163,10.2211 4.00548,10.1274 3.98982,10.0216 4.00686,9.9186 4.02389,9.8156 4.07276,9.7205 4.14661,9.6466 4.22045,9.5728 4.31557,9.5239 4.41861,9.5069 4.52164,9.48982 4.62743,9.5055 4.72111,9.5516 4.8148,9.5978 4.89168,9.6721 4.94097,9.7642 4.99026,9.8563 5.00948,9.9614 4.99594,10.065 4.98164,10.1743 4.93165,10.2758 4.85371,10.3537 4.77578,10.4316 4.67428,10.4816 4.565,10.4959 Z m 0,-2.49996 C 4.46145,8.00948 4.35625,7.99026 4.26418,7.94097 4.17211,7.89168 4.09778,7.8148 4.05163,7.72111 4.00548,7.62743 3.98982,7.52164 4.00686,7.41861 4.02389,7.31557 4.07276,7.22045 4.14661,7.14661 4.22045,7.07276 4.31557,7.02389 4.41861,7.00686 4.52164,6.98982 4.62743,7.00548 4.72111,7.05163 4.8148,7.09778 4.89168,7.17211 4.94097,7.26418 4.99026,7.35625 5.00948,7.46145 4.99594,7.565 4.98164,7.67428 4.93165,7.77578 4.85371,7.85371 4.77578,7.93165 4.67428,7.98164 4.565,7.99594 Z m 0,-2.5 C 4.46145,5.50948 4.35625,5.49026 4.26418,5.44097 4.17211,5.39168 4.09778,5.3148 4.05163,5.22111 4.00548,5.12743 3.98982,5.02164 4.00686,4.91861 4.02389,4.81557 4.07276,4.72045 4.14661,4.64661 4.22045,4.57276 4.31557,4.52389 4.41861,4.50686 4.52164,4.48982 4.62743,4.50548 4.72111,4.55163 4.8148,4.59778 4.89168,4.67211 4.94097,4.76418 4.99026,4.85625 5.00948,4.96145 4.99594,5.065 4.98164,5.17428 4.93165,5.27578 4.85371,5.35371 4.77578,5.43164 4.67428,5.48164 4.565,5.49594 Z m 0,-2.5 C 4.46145,3.00948 4.35625,2.99026 4.26418,2.94097 4.17211,2.89168 4.09778,2.8148 4.05163,2.72111 4.00548,2.62743 3.98982,2.52164 4.00686,2.41861 4.02389,2.31557 4.07276,2.22045 4.14661,2.14661 4.22045,2.07276 4.31557,2.02389 4.41861,2.00686 4.52164,1.98982 4.62743,2.00548 4.72111,2.05163 4.8148,2.09778 4.89168,2.17211 4.94097,2.26418 4.99026,2.35625 5.00948,2.46145 4.99594,2.565 4.98164,2.67428 4.93165,2.77578 4.85371,2.85371 4.77578,2.93165 4.67428,2.98165 4.565,2.99594 Z m 2.5,9.99996 C 6.96145,13.0095 6.85625,12.9903 6.76418,12.941 6.67211,12.8917 6.59778,12.8148 6.55163,12.7211 6.50548,12.6274 6.48982,12.5216 6.50686,12.4186 c 0.01703,-0.103 0.0659,-0.1981 0.13975,-0.272 0.07384,-0.0738 0.16896,-0.1227 0.272,-0.1397 0.10303,-0.0171 0.20882,-0.0014 0.3025,0.0447 0.09369,0.0462 0.17057,0.1205 0.21986,0.2126 0.04929,0.0921 0.06851,0.1972 0.05497,0.3008 -0.0143,0.1093 -0.06429,0.2108 -0.14223,0.2887 -0.07793,0.0779 -0.17943,0.1279 -0.28871,0.1422 z m 0,-2.5 C 6.96145,10.5095 6.85625,10.4903 6.76418,10.441 6.67211,10.3917 6.59778,10.3148 6.55163,10.2211 6.50548,10.1274 6.48982,10.0216 6.50686,9.9186 6.52389,9.8156 6.57276,9.7205 6.64661,9.6466 6.72045,9.5728 6.81557,9.5239 6.91861,9.5069 7.02164,9.48982 7.12743,9.5055 7.22111,9.5516 7.3148,9.5978 7.39168,9.6721 7.44097,9.7642 7.49026,9.8563 7.50948,9.9614 7.49594,10.065 7.48164,10.1743 7.43165,10.2758 7.35371,10.3537 7.27578,10.4316 7.17428,10.4816 7.065,10.4959 Z m 0,-2.49996 C 6.96145,8.00948 6.85625,7.99026 6.76418,7.94097 6.67211,7.89168 6.59778,7.8148 6.55163,7.72111 6.50548,7.62743 6.48982,7.52164 6.50686,7.41861 6.52389,7.31557 6.57276,7.22045 6.64661,7.14661 6.72045,7.07276 6.81557,7.02389 6.91861,7.00686 7.02164,6.98982 7.12743,7.00548 7.22111,7.05163 7.3148,7.09778 7.39168,7.17211 7.44097,7.26418 7.49026,7.35625 7.50948,7.46145 7.49594,7.565 7.48164,7.67428 7.43165,7.77578 7.35371,7.85371 7.27578,7.93165 7.17428,7.98164 7.065,7.99594 Z m 0,-2.5 C 6.96145,5.50948 6.85625,5.49026 6.76418,5.44097 6.67211,5.39168 6.59778,5.3148 6.55163,5.22111 6.50548,5.12743 6.48982,5.02164 6.50686,4.91861 6.52389,4.81557 6.57276,4.72045 6.64661,4.64661 6.72045,4.57276 6.81557,4.52389 6.91861,4.50686 7.02164,4.48982 7.12743,4.50548 7.22111,4.55163 7.3148,4.59778 7.39168,4.67211 7.44097,4.76418 7.49026,4.85625 7.50948,4.96145 7.49594,5.065 7.48164,5.17428 7.43165,5.27578 7.35371,5.35371 7.27578,5.43164 7.17428,5.48164 7.065,5.49594 Z m 0,-2.5 C 6.96145,3.00948 6.85625,2.99026 6.76418,2.94097 6.67211,2.89168 6.59778,2.8148 6.55163,2.72111 6.50548,2.62743 6.48982,2.52164 6.50686,2.41861 6.52389,2.31557 6.57276,2.22045 6.64661,2.14661 6.72045,2.07276 6.81557,2.02389 6.91861,2.00686 7.02164,1.98982 7.12743,2.00548 7.22111,2.05163 7.3148,2.09778 7.39168,2.17211 7.44097,2.26418 7.49026,2.35625 7.50948,2.46145 7.49594,2.565 7.48164,2.67428 7.43165,2.77578 7.35371,2.85371 7.27578,2.93165 7.17428,2.98165 7.065,2.99594 Z M 12.875,14 H 9 V 6 h 3.5 c 0.1326,0 0.2598,0.05268 0.3536,0.14645 C 12.9473,6.24021 13,6.36739 13,6.5 v 7.375 c 0,0.0332 -0.0132,0.0649 -0.0366,0.0884 C 12.9399,13.9868 12.9082,14 12.875,14 Z"},
                {fillRule: FILL_RULE.nonzero, fill: "rgba(17, 34, 17, 0.2)", stroke: "unset", strokeLinecap: STROKE_LINECAP.butt, strokeWidth: "unset", strokeLinejoin: STROKE_LINEJOIN.miter, d: "m 11.5,12 c -0.0989,0 -0.1956,0.0293 -0.2778,0.0843 -0.0822,0.0549 -0.1463,0.133 -0.1841,0.2244 -0.0379,0.0913 -0.0478,0.1919 -0.0285,0.2888 0.0193,0.097 0.0669,0.1861 0.1368,0.2561 0.07,0.0699 0.1591,0.1175 0.2561,0.1368 0.0969,0.0193 0.1975,0.0094 0.2888,-0.0285 0.0914,-0.0378 0.1695,-0.1019 0.2244,-0.1841 C 11.9707,12.6956 12,12.5989 12,12.5 12,12.3674 11.9473,12.2402 11.8536,12.1464 11.7598,12.0527 11.6326,12 11.5,12 Z m 0,-2.5 c -0.0989,0 -0.1956,0.0293 -0.2778,0.0843 -0.0822,0.0549 -0.1463,0.133 -0.1841,0.2244 -0.0379,0.0913 -0.0478,0.1919 -0.0285,0.2888 0.0193,0.097 0.0669,0.1861 0.1368,0.2561 0.07,0.0699 0.1591,0.1175 0.2561,0.1368 0.0969,0.0193 0.1975,0.0094 0.2888,-0.0285 0.0914,-0.0378 0.1695,-0.1019 0.2244,-0.1841 C 11.9707,10.1956 12,10.0989 12,10 12,9.8674 11.9473,9.7402 11.8536,9.6464 11.7598,9.5527 11.6326,9.5 11.5,9.5 Z M 11.5,7 C 11.4011,7 11.3044,7.02932 11.2222,7.08427 11.14,7.13921 11.0759,7.2173 11.0381,7.30866 c -0.0379,0.09136 -0.0478,0.1919 -0.0285,0.28889 0.0193,0.09699 0.0669,0.18608 0.1368,0.256 0.07,0.06993 0.1591,0.11755 0.2561,0.13684 C 11.4994,8.00969 11.6,7.99978 11.6913,7.96194 11.7827,7.9241 11.8608,7.86001 11.9157,7.77779 11.9707,7.69556 12,7.59889 12,7.5 12,7.36739 11.9473,7.24021 11.8536,7.14645 11.7598,7.05268 11.6326,7 11.5,7 Z m -2,5 C 9.4011,12 9.3044,12.0293 9.2222,12.0843 9.14,12.1392 9.0759,12.2173 9.0381,12.3087 9.0002,12.4 8.99032,12.5006 9.0096,12.5975 c 0.0193,0.097 0.0669,0.1861 0.1368,0.2561 0.07,0.0699 0.1591,0.1175 0.2561,0.1368 C 9.4994,13.0097 9.6,12.9998 9.6913,12.9619 9.7827,12.9241 9.8608,12.86 9.9157,12.7778 9.9707,12.6956 10,12.5989 10,12.5 10,12.3674 9.9473,12.2402 9.8536,12.1464 9.7598,12.0527 9.6326,12 9.5,12 Z m 0,-2.5 C 9.4011,9.5 9.3044,9.5293 9.2222,9.5843 9.14,9.6392 9.0759,9.7173 9.0381,9.8087 9.0002,9.9 8.99032,10.0006 9.0096,10.0975 c 0.0193,0.097 0.0669,0.1861 0.1368,0.2561 0.07,0.0699 0.1591,0.1175 0.2561,0.1368 C 9.4994,10.5097 9.6,10.4998 9.6913,10.4619 9.7827,10.4241 9.8608,10.36 9.9157,10.2778 9.9707,10.1956 10,10.0989 10,10 10,9.8674 9.9473,9.7402 9.8536,9.6464 9.7598,9.5527 9.6326,9.5 9.5,9.5 Z M 9.5,7 C 9.4011,7 9.3044,7.02932 9.2222,7.08427 9.14,7.13921 9.0759,7.2173 9.0381,7.30866 9.0002,7.40002 8.99032,7.50056 9.0096,7.59755 9.0289,7.69454 9.0765,7.78363 9.1464,7.85355 9.2164,7.92348 9.3055,7.9711 9.4025,7.99039 9.4994,8.00969 9.6,7.99978 9.6913,7.96194 9.7827,7.9241 9.8608,7.86001 9.9157,7.77779 9.9707,7.69556 10,7.59889 10,7.5 10,7.36739 9.9473,7.24021 9.8536,7.14645 9.7598,7.05268 9.6326,7 9.5,7 Z"}
            ]
        }
    ;

    return(
        <section 
            className={[
                "details__ticket", "ticket", contentType === SITE_PARTS.flights ? "flights" : "hotels"
            ].join(" ")}
        >
            <div className="container">
                <div className="ticket__schedule">
                    <div className="ticket__schedule-part schedule-part-ticket">
                        <time className="schedule-part-ticket__time" dateTime={startDate}>{startString}</time>
                        <div className="schedule-part-ticket__description">
                            {startDescription}
                        </div>
                    </div>
                    <div className="ticket__schedule-separation separation-schedule-ticket">
                        <span className="separation-schedule-ticket__start"></span>
                        <div className="separation-schedule-ticket__icon-parent">
                            <svg 
                                className="separation-schedule-ticket__icon" 
                                viewBox={transformIconViewbox(iconValue.viewbox)} 
                                width={iconValue.width} height={iconValue.height}
                            >
                                {iconValue.pathes.map((path, i) => <path key={i} {...path} />)}
                            </svg>
                        </div>
                        <span className="separation-schedule-ticket__end"></span>
                    </div>
                    <div className="ticket__schedule-part schedule-part-ticket">
                        <time className="schedule-part-ticket__time" dateTime={endDate}>{endString}</time>
                        <div className="schedule-part-ticket__description">
                            {endDescription}
                        </div>
                    </div>
                </div>
                <div className="ticket__main main-ticket">
                    <div className="main-ticket__header">
                        <picture className="main-ticket__user-ava">
                            <source srcSet="" type="image/webp" />
                            <img src="" alt="Ava" />
                        </picture>
                        {contentType === SITE_PARTS.flights 
                            ? <div className="main-ticket__subava">
                                <div className="main-ticket__owner in-block">James Doe</div>
                                <div className="main-ticket__boarding-pass">{"Boarding Pass N’" + 125}</div>
                            </div>
                            : <div className="main-ticket__owner">James Doe</div>
                        }
                        <div className="main-ticket__service-description">{serviceDescription}</div>
                    </div>
                    <div className="main-ticket__container">
                        <div className="main-ticket__features">
                            {features.map((feature, i) => <TicketFeature key={i} {...feature} />)}
                        </div>
                        <div className="main-ticket__codes codes-main-ticket">
                            <div className="codes-main-ticket__first">EK</div>
                            <div className="codes-main-ticket__second">ABC12345</div>
                        </div>
                    </div>
                </div>
                {images.length === 1
                    ? <div className="ticket__images images-ticket room">
                        <picture className="images-ticket__hotel-logo">
                            <source srcSet={images[0].srcs.webp} type="image/webp" />
                            <img src={images[0].srcs.jpeg} alt={images[0].alt} />
                        </picture>
                    </div>
                    : <div className="ticket__images images-ticket airline">
                        {images.map((image, i) => 
                            <div 
                                className={[
                                    "images-ticket__place", "place-images-ticket", i === 0 ? "from" : "to"
                                ].join(" ")} 
                                key={i}
                            >
                                <picture className="place-images-ticket__image">
                                    <source srcSet={image.srcs.webp} type="image/webp" />
                                    <img src={image.srcs.jpeg} alt={image.alt} />
                                </picture>
                                <div className="place-images-ticket__subimage">
                                    <h3 className="place-images-ticket__user">James Doe</h3>
                                    <div className="place-images-ticket__boarding-pass">Boarding Pass N’123</div>
                                </div>
                            </div>
                        )}
                    </div>
                }
            </div>
        </section>
    )
}